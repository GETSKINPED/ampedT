"use strict";var myskinProtector={};myskinProtector["getSkinExt"]=function(buffer){var ser=buffer.unserializeSer();var max=0;var compare=function(tex){var br=new BufferReader(tex);var name=br.readUTFJava();var pixelType=br.readIntJava();var width=br.readIntJava();var height=br.readIntJava();max=Math.max(max,width,height);};if(ser["face"]&&ser["face"]["tex"]&&ser["face"]["tex"].length){for(var i=0;i<ser["face"]["tex"].length;i++){compare(ser["face"]["tex"][i]);}}
return(max>128?"hhskin":(max>64?"hskin":"skin"));};myskinProtector["isShow"]=function(tag,list){var s=tag.split("^");for(var i=0;i<list.length;i++){if((list[i]["ext"]||list[i]["type"])==s[0]){var ext=myskinProtector["getSkinExt"](list[i]["buffer"]);if(ext==s[1]){return true;}}}
return false;};myskinProtector["getFileList"]=function(tag,list){var v=[];var s=tag.split("^");for(var i=0;i<list.length;i++){var f=new FileInfo(list[i]["path"],list[i]["buffer"]);if((f.ext||f.type)==s[0]){var ext=myskinProtector["getSkinExt"](list[i]["buffer"]);if(ext==s[1]){v.push({"path":(list[i]["path"].indexOf(".")!=-1?list[i]["path"].slice(0,list[i]["path"].length-("."+s[0]).length):list[i]["path"])+"."+ext,"ext":ext,"type":ext,"index":i});}}}
return v;};myskinProtector["transData"]=function(tag,buffer){var s=tag.split("^");var kar=(function(){if(window["Kar"]){return new window["Kar"](new FileInfo("."+s[1]));}})();if(kar){if(buffer.startsWith(Header["NewSkinData"]["header"])){var ser=buffer.unserializeSer();if(ser["userID"]){kar.addFile({"path":ser["userID"]+"/myskin","buffer":buffer});}}
kar.addFile({"path":"myskin","buffer":buffer});return kar.to();}};TransList["myskin^skin"]={"isShow":myskinProtector["isShow"],"getFileList":myskinProtector["getFileList"],"transData":myskinProtector["transData"]};TransList["myskin^hskin"]={"isShow":myskinProtector["isShow"],"getFileList":myskinProtector["getFileList"],"transData":myskinProtector["transData"]};TransList["myskin^hhskin"]={"isShow":myskinProtector["isShow"],"getFileList":myskinProtector["getFileList"],"transData":myskinProtector["transData"]};UpdateTransList();UpdatePluginList("myskinProtector");